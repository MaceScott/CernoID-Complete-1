"use strict";(()=>{var e={};e.id=16,e.ids=[16],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8709:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2361:e=>{e.exports=require("events")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},3837:e=>{e.exports=require("util")},9796:e=>{e.exports=require("zlib")},9951:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>w,originalPathname:()=>q,patchFetch:()=>D,requestAsyncStorage:()=>h,routeModule:()=>v,serverHooks:()=>f,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>x});var i={};r.r(i),r.d(i,{GET:()=>m,POST:()=>y});var a=r(5419),n=r(9108),s=r(9678),o=r(8070),u=r(2196),p=r(1906),l=r(2002),c=r(2177);let d=c.PaginationSchema.extend({startDate:u.z.string().optional(),endDate:u.z.string().optional(),type:u.z.string().optional(),location:u.z.string().optional(),severity:u.z.enum(["low","medium","high"]).optional(),personId:u.z.string().optional()});async function m(e){return(0,c.withAuth)(async()=>{let{searchParams:t}=new URL(e.url),r=(0,c.parseQueryParams)(t,d),i={...r.startDate&&{timestamp:{gte:new Date(r.startDate)}},...r.endDate&&{timestamp:{...r.startDate&&{gte:new Date(r.startDate)}||{},lte:new Date(r.endDate)}},...r.type&&{type:r.type},...r.location&&{location:r.location},...r.severity&&{severity:r.severity},...r.personId&&{personId:r.personId}},[a,n]=await Promise.all([p._.securityEvent.count({where:i}),p._.securityEvent.findMany({where:i,orderBy:{timestamp:"desc"},take:r.limit||10,skip:r.offset||0,include:{person:{select:{id:!0,name:!0,email:!0}}}})]);return(0,c.buildPaginationResponse)(n,a,r.limit||10,r.offset||0)})}async function y(e){return(0,c.withAuth)(async t=>{if(!t)throw Error("User is required");let r=await e.json(),i=l.SecurityEventSchema.parse(r),a=await p._.securityEvent.create({data:{...i,createdBy:t.id},include:{person:{select:{id:!0,name:!0,email:!0}}}});return o.Z.json(a,{status:201})})}let v=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/security/events/route",pathname:"/api/security/events",filename:"route",bundlePath:"app/api/security/events/route"},resolvedPagePath:"C:\\Users\\maces\\CernoID-Complete-1\\frontend\\app\\api\\security\\events\\route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:h,staticGenerationAsyncStorage:g,serverHooks:f,headerHooks:w,staticGenerationBailout:x}=v,q="/api/security/events/route";function D(){return(0,s.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:g})}},2177:(e,t,r)=>{r(8070)},2002:(e,t,r)=>{r(6929)},1906:(e,t,r)=>{r.d(t,{_:()=>a});let i=require("@prisma/client"),a=global.prisma||new i.PrismaClient}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[52,765,929],()=>r(9951));module.exports=i})();