(()=>{var e={};e.id=626,e.ids=[626],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},45660:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var n=r(50482),o=r(69108),a=r(62563),i=r.n(a),s=r(68300),l={};for(let e in s)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>s[e]);r.d(t,l);let d=["",{children:["login",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,43015)),"C:\\Users\\maces\\CernoID-Complete-1\\frontend\\app\\login\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,9421)),"C:\\Users\\maces\\CernoID-Complete-1\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,69361,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\maces\\CernoID-Complete-1\\frontend\\app\\login\\page.tsx"],u="/login/page",h={require:r,loadChunk:()=>Promise.resolve()},p=new n.AppPageRouteModule({definition:{kind:o.x.APP_PAGE,page:"/login/page",pathname:"/login",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},44082:(e,t,r)=>{Promise.resolve().then(r.bind(r,42382))},89012:(e,t,r)=>{Promise.resolve().then(r.bind(r,37059))},56694:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2583,23)),Promise.resolve().then(r.t.bind(r,26840,23)),Promise.resolve().then(r.t.bind(r,38771,23)),Promise.resolve().then(r.t.bind(r,13225,23)),Promise.resolve().then(r.t.bind(r,9295,23)),Promise.resolve().then(r.t.bind(r,43982,23))},20412:(e,t,r)=>{"use strict";r.d(t,{aC:()=>a});var n=r(3729),o=r(62783);function a(){let e=(0,n.useContext)(o.V);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}r(8428)},37059:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>W});var n=r(95344),o=r(3729),a=r(20412),i=r(8428),s=r(56506),l=r(72663),d=r(56739),c=r(43584),u=r(65442),h=r(24311),p=r(51848),g=r(65651),f=r(56815),m=r(10581),x=r(85866),y=r(39448),v=r(27279),w=r(16720),b=r(3722),j=r(30732),P=r(15543);function C(e){return(0,P.ZP)("MuiLink",e)}let L=(0,j.Z)("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]);var Z=r(6224),S=r(31143);let E={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},k=e=>E[e]||e,A=({theme:e,ownerState:t})=>{let r=k(t.color),n=(0,Z.DW)(e,`palette.${r}`,!1)||t.color,o=(0,Z.DW)(e,`palette.${r}Channel`);return"vars"in e&&o?`rgba(${o} / 0.4)`:(0,S.Fq)(n,.4)},D=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],_=e=>{let{classes:t,component:r,focusVisible:n,underline:o}=e,a={root:["root",`underline${(0,x.Z)(o)}`,"button"===r&&"button",n&&"focusVisible"]};return(0,m.Z)(a,C,t)},O=(0,y.ZP)(u.Z,{name:"MuiLink",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,t[`underline${(0,x.Z)(r.underline)}`],"button"===r.component&&t.button]}})(({theme:e,ownerState:t})=>(0,g.Z)({},"none"===t.underline&&{textDecoration:"none"},"hover"===t.underline&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},"always"===t.underline&&(0,g.Z)({textDecoration:"underline"},"inherit"!==t.color&&{textDecorationColor:A({theme:e,ownerState:t})},{"&:hover":{textDecorationColor:"inherit"}}),"button"===t.component&&{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${L.focusVisible}`]:{outline:"auto"}})),R=o.forwardRef(function(e,t){let r=(0,v.i)({props:e,name:"MuiLink"}),{className:a,color:i="primary",component:s="a",onBlur:l,onFocus:d,TypographyClasses:c,underline:u="always",variant:h="inherit",sx:m}=r,x=(0,p.Z)(r,D),{isFocusVisibleRef:y,onBlur:j,onFocus:P,ref:C}=(0,w.Z)(),[L,Z]=o.useState(!1),S=(0,b.Z)(t,C),k=(0,g.Z)({},r,{color:i,component:s,focusVisible:L,underline:u,variant:h}),A=_(k);return(0,n.jsx)(O,(0,g.Z)({color:i,className:(0,f.Z)(A.root,a),classes:c,component:s,onBlur:e=>{j(e),!1===y.current&&Z(!1),l&&l(e)},onFocus:e=>{P(e),!0===y.current&&Z(!0),d&&d(e)},ref:S,ownerState:k,variant:h,sx:[...Object.keys(E).includes(i)?[]:[{color:i}],...Array.isArray(m)?m:[m]]},x))});var T=r(65183),q=r(44504);let M=()=>{let{login:e,loginWithFace:t}=(0,a.aC)(),[r,p]=(0,o.useState)(!1),[g,f]=(0,o.useState)(null),m=(0,i.useRouter)();(0,o.useRef)(null);let[x,y]=(0,o.useState)({email:"",password:""}),v=e=>{let{name:t,value:r}=e.target;y(e=>({...e,[t]:r}))},w=async t=>{t.preventDefault(),f(null),p(!0);try{await e(x),m.push("/dashboard")}catch(e){f("Login failed. Please check your credentials.")}finally{p(!1)}},b=async()=>{f(null),p(!0);try{let e=await navigator.mediaDevices.getUserMedia({video:!0}),r=document.createElement("video");r.srcObject=e,await r.play();let n=document.createElement("canvas");n.width=r.videoWidth,n.height=r.videoHeight;let o=n.getContext("2d");if(!o)throw Error("Could not get canvas context");o.drawImage(r,0,0,n.width,n.height),e.getTracks().forEach(e=>e.stop());let a=n.toDataURL("image/jpeg");await t(a),m.push("/dashboard")}catch(e){f("Face login failed. Please try again or use email/password.")}finally{p(!1)}};return n.jsx(l.Z,{maxWidth:"sm",children:n.jsx(d.Z,{sx:{mt:8},children:(0,n.jsxs)(c.Z,{sx:{p:4},children:[n.jsx(u.Z,{variant:"h4",component:"h1",gutterBottom:!0,align:"center",children:"Login"}),g&&n.jsx(u.Z,{color:"error",align:"center",gutterBottom:!0,children:g}),(0,n.jsxs)("form",{onSubmit:w,children:[n.jsx(h.Z,{fullWidth:!0,margin:"normal",label:"Email",name:"email",type:"email",value:x.email,onChange:v,disabled:r,required:!0}),n.jsx(h.Z,{fullWidth:!0,margin:"normal",label:"Password",name:"password",type:"password",value:x.password,onChange:v,disabled:r,required:!0}),n.jsx(d.Z,{sx:{mt:1,mb:2,textAlign:"right"},children:n.jsx(s.default,{href:"/forgot-password",passHref:!0,children:n.jsx(R,{variant:"body2",children:"Forgot password?"})})}),(0,n.jsxs)(d.Z,{sx:{mt:3,display:"flex",flexDirection:"column",gap:2},children:[n.jsx(T.Z,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,disabled:r,children:r?n.jsx(q.Z,{size:24}):"Login with Email"}),n.jsx(T.Z,{type:"button",variant:"outlined",color:"primary",fullWidth:!0,onClick:b,disabled:r,children:r?n.jsx(q.Z,{size:24}):"Login with Face"})]})]})]})})})};function W(){return n.jsx(l.Z,{maxWidth:"sm",children:n.jsx(d.Z,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:n.jsx(M,{})})})}},62783:(e,t,r)=>{"use strict";r.d(t,{H:()=>s,V:()=>i});var n=r(95344),o=r(3729),a=r(8428);let i=(0,o.createContext)(null);function s({children:e}){let t=(0,a.useRouter)(),[r,s]=(0,o.useState)({user:null,isAuthenticated:!1,isLoading:!0,error:null}),l=e=>{s(t=>({...t,error:e}))},d=async e=>{try{l(null),s(e=>({...e,isLoading:!0})),s(t=>({...t,user:e,isAuthenticated:!0,isLoading:!1})),t.push("/dashboard")}catch(e){throw s(t=>({...t,isLoading:!1,error:e instanceof Error?e.message:"Login failed"})),e}},c=async e=>{try{l(null),s(e=>({...e,isLoading:!0}));let r=await fetch("/api/auth/login/face",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({faceData:e})});if(!r.ok)throw Error("Face recognition login failed");let n=await r.json();if(!n.success||!n.data?.user)throw Error(n.error||"Face recognition login failed");s(e=>({...e,user:n.data.user,isAuthenticated:!0,isLoading:!1})),t.push("/dashboard")}catch(e){throw s(t=>({...t,isLoading:!1,error:e instanceof Error?e.message:"Face recognition login failed"})),e}},u=async e=>{try{l(null),s(e=>({...e,isLoading:!0}));let r=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!r.ok)throw Error("Registration failed");let n=await r.json();if(!n.success||!n.data?.user)throw Error(n.error||"Registration failed");s(e=>({...e,user:n.data.user,isAuthenticated:!0,isLoading:!1})),t.push("/dashboard")}catch(e){throw s(t=>({...t,isLoading:!1,error:e instanceof Error?e.message:"Registration failed"})),e}},h=async()=>{try{l(null),s(e=>({...e,isLoading:!0})),await fetch("/api/auth/logout",{method:"POST",credentials:"include"}),s({user:null,isAuthenticated:!1,isLoading:!1,error:null}),t.push("/login")}catch(e){s(t=>({...t,isLoading:!1,error:e instanceof Error?e.message:"Logout failed"}))}},p=async e=>{try{l(null),s(e=>({...e,isLoading:!0}));let t=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:e})});if(!t.ok)throw Error("Password reset failed");let r=await t.json();if(!r.success)throw Error(r.error||"Password reset failed");s(e=>({...e,isLoading:!1}))}catch(e){throw s(t=>({...t,isLoading:!1,error:e instanceof Error?e.message:"Password reset failed"})),e}},g=async(e,r,n)=>{try{l(null),s(e=>({...e,isLoading:!0}));let o=await fetch("/api/auth/update-password",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({token:e,password:r,confirmPassword:n})});if(!o.ok)throw Error("Password update failed");let a=await o.json();if(!a.success)throw Error(a.error||"Password update failed");s(e=>({...e,isLoading:!1})),t.push("/login")}catch(e){throw s(t=>({...t,isLoading:!1,error:e instanceof Error?e.message:"Password update failed"})),e}};(0,o.useEffect)(()=>{(async function(){try{let e=await fetch("/api/auth/me",{method:"GET",credentials:"include"});if(!e.ok)throw Error("Authentication check failed");let t=await e.json();t.success&&t.data?.user?s({user:t.data.user,isAuthenticated:!0,isLoading:!1,error:null}):s({user:null,isAuthenticated:!1,isLoading:!1,error:null})}catch(e){s({user:null,isAuthenticated:!1,isLoading:!1,error:e instanceof Error?e.message:"Authentication check failed"})}})()},[]);let f={...r,login:d,loginWithFace:c,register:u,logout:h,resetPassword:p,updatePassword:g};return n.jsx(i.Provider,{value:f,children:e})}},42382:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Providers:()=>h});var n=r(95344),o=r(62783),a=r(69738),i=r(77760);let s=(0,a.Z)({palette:{primary:{main:"#1976d2",light:"#42a5f5",dark:"#1565c0"},secondary:{main:"#9c27b0",light:"#ba68c8",dark:"#7b1fa2"},error:{main:"#d32f2f",light:"#ef5350",dark:"#c62828"},background:{default:"#f5f5f5",paper:"#ffffff"}},typography:{fontFamily:'-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif'},shape:{borderRadius:8},components:{MuiButton:{styleOverrides:{root:{textTransform:"none",fontWeight:600}}},MuiPaper:{styleOverrides:{root:{backgroundImage:"none"}}}}});function l({children:e}){return n.jsx(i.Z,{theme:s,children:e})}var d=r(3729);let c=(0,d.createContext)(null);function u({children:e}){let t=function({url:e="ws://localhost:3000/ws",onMessage:t,onError:r,onClose:n,onOpen:o,reconnectAttempts:a=5,reconnectInterval:i=3e3}={}){let[s,l]=(0,d.useState)(!1),[c,u]=(0,d.useState)(null),[h,p]=(0,d.useState)([]),g=(0,d.useRef)(null),f=(0,d.useRef)(0);return(0,d.useEffect)(()=>{let s=()=>{try{let d=new WebSocket(e);d.onopen=e=>{l(!0),u(null),f.current=0,o?.(e)},d.onmessage=e=>{p(t=>[...t,e.data]);try{let r=JSON.parse(e.data);t?.(r)}catch(r){t?.({type:"raw",data:e.data})}},d.onerror=e=>{u(e),r?.(e)},d.onclose=e=>{l(!1),n?.(e),f.current<a&&setTimeout(()=>{f.current+=1,s()},i)},g.current=d}catch(e){u(e),r?.(e)}};return s(),()=>{g.current&&g.current.close()}},[e,t,r,n,o,a,i]),{isConnected:s,error:c,send:e=>{g.current&&s&&g.current.send("string"==typeof e?e:JSON.stringify(e))},messages:h}}();return n.jsx(c.Provider,{value:t,children:e})}function h({children:e}){return n.jsx(l,{children:n.jsx(o.H,{children:n.jsx(u,{children:e})})})}},9421:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h,metadata:()=>u});var n=r(25036),o=r(80265),a=r.n(o);r(67272);var i=r(86843);let s=(0,i.createProxy)(String.raw`C:\Users\maces\CernoID-Complete-1\frontend\app\providers\providers.tsx`),{__esModule:l,$$typeof:d}=s;s.default;let c=(0,i.createProxy)(String.raw`C:\Users\maces\CernoID-Complete-1\frontend\app\providers\providers.tsx#Providers`),u={title:"CernoID - Secure Access Control",description:"Advanced facial recognition and access control system"};function h({children:e}){return n.jsx("html",{lang:"en",children:n.jsx("body",{className:a().className,children:n.jsx(c,{children:e})})})}},43015:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>a,__esModule:()=>o,default:()=>i});let n=(0,r(86843).createProxy)(String.raw`C:\Users\maces\CernoID-Complete-1\frontend\app\login\page.tsx`),{__esModule:o,$$typeof:a}=n,i=n.default},67272:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[638,961,667,307,610,332,754,506],()=>r(45660));module.exports=n})();