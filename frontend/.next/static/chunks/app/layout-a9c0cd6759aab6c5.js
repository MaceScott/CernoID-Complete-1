(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{12618:function(e,t,r){Promise.resolve().then(r.t.bind(r,52445,23)),Promise.resolve().then(r.bind(r,38992)),Promise.resolve().then(r.t.bind(r,43445,23))},84586:function(e,t,r){"use strict";r.d(t,{H:function(){return s},V:function(){return a}});var n=r(3827),i=r(64090),o=r(47907);let a=(0,i.createContext)(null);function s(e){let{children:t}=e,r=(0,o.useRouter)(),[s,l]=(0,i.useState)({user:null,isAuthenticated:!1,isLoading:!0,error:null}),u=e=>{l(t=>({...t,error:e}))},c=async e=>{try{u(null),l(e=>({...e,isLoading:!0})),l(t=>({...t,user:e,isAuthenticated:!0,isLoading:!1})),r.push("/dashboard")}catch(e){throw l(t=>({...t,isLoading:!1,error:e instanceof Error?e.message:"Login failed"})),e}},d=async e=>{try{var t;u(null),l(e=>({...e,isLoading:!0}));let n=await fetch("/api/auth/login/face",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({faceData:e})});if(!n.ok)throw Error("Face recognition login failed");let i=await n.json();if(!i.success||!(null===(t=i.data)||void 0===t?void 0:t.user))throw Error(i.error||"Face recognition login failed");l(e=>({...e,user:i.data.user,isAuthenticated:!0,isLoading:!1})),r.push("/dashboard")}catch(e){throw l(t=>({...t,isLoading:!1,error:e instanceof Error?e.message:"Face recognition login failed"})),e}},f=async e=>{try{var t;u(null),l(e=>({...e,isLoading:!0}));let n=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!n.ok)throw Error("Registration failed");let i=await n.json();if(!i.success||!(null===(t=i.data)||void 0===t?void 0:t.user))throw Error(i.error||"Registration failed");l(e=>({...e,user:i.data.user,isAuthenticated:!0,isLoading:!1})),r.push("/dashboard")}catch(e){throw l(t=>({...t,isLoading:!1,error:e instanceof Error?e.message:"Registration failed"})),e}},h=async()=>{try{u(null),l(e=>({...e,isLoading:!0})),await fetch("/api/auth/logout",{method:"POST",credentials:"include"}),l({user:null,isAuthenticated:!1,isLoading:!1,error:null}),r.push("/login")}catch(e){l(t=>({...t,isLoading:!1,error:e instanceof Error?e.message:"Logout failed"}))}},g=async e=>{try{u(null),l(e=>({...e,isLoading:!0}));let t=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:e})});if(!t.ok)throw Error("Password reset failed");let r=await t.json();if(!r.success)throw Error(r.error||"Password reset failed");l(e=>({...e,isLoading:!1}))}catch(e){throw l(t=>({...t,isLoading:!1,error:e instanceof Error?e.message:"Password reset failed"})),e}},p=async(e,t,n)=>{try{u(null),l(e=>({...e,isLoading:!0}));let i=await fetch("/api/auth/update-password",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({token:e,password:t,confirmPassword:n})});if(!i.ok)throw Error("Password update failed");let o=await i.json();if(!o.success)throw Error(o.error||"Password update failed");l(e=>({...e,isLoading:!1})),r.push("/login")}catch(e){throw l(t=>({...t,isLoading:!1,error:e instanceof Error?e.message:"Password update failed"})),e}};(0,i.useEffect)(()=>{!async function(){try{var e;let t=await fetch("/api/auth/me",{method:"GET",credentials:"include"});if(!t.ok)throw Error("Authentication check failed");let r=await t.json();r.success&&(null===(e=r.data)||void 0===e?void 0:e.user)?l({user:r.data.user,isAuthenticated:!0,isLoading:!1,error:null}):l({user:null,isAuthenticated:!1,isLoading:!1,error:null})}catch(e){l({user:null,isAuthenticated:!1,isLoading:!1,error:e instanceof Error?e.message:"Authentication check failed"})}}()},[]);let y={...s,login:c,loginWithFace:d,register:f,logout:h,resetPassword:g,updatePassword:p};return(0,n.jsx)(a.Provider,{value:y,children:t})}},38992:function(e,t,r){"use strict";r.r(t),r.d(t,{Providers:function(){return _}});var n=r(3827),i=r(84586),o=r(99136),a=r(14749),s=r(70444),l=r(64090);let u=l.createContext(null);function c(){return l.useContext(u)}var d="function"==typeof Symbol&&Symbol.for?Symbol.for("mui.nested"):"__THEME_NESTED__",f=function(e){let{children:t,theme:r}=e,i=c(),o=l.useMemo(()=>{let e=null===i?r:"function"==typeof r?r(i):(0,a.Z)({},i,r);return null!=e&&(e[d]=null!==i),e},[r,i]);return(0,n.jsx)(u.Provider,{value:o,children:t})},h=r(66216),g=r(61733),p=r(93346),y=r(99431);let m={};function v(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return l.useMemo(()=>{let i=e&&t[e]||t;if("function"==typeof r){let o=r(i),s=e?(0,a.Z)({},t,{[e]:o}):o;return n?()=>s:s}return e?(0,a.Z)({},t,{[e]:r}):(0,a.Z)({},t,r)},[e,t,r,n])}var w=function(e){let{children:t,theme:r,themeId:i}=e,o=(0,g.Z)(m),a=c()||m,s=v(i,o,r),l=v(i,a,r,!0),u="rtl"===s.direction;return(0,n.jsx)(f,{theme:l,children:(0,n.jsx)(h.T.Provider,{value:s,children:(0,n.jsx)(p.Z,{value:u,children:(0,n.jsx)(y.Z,{value:null==s?void 0:s.components,children:t})})})})},E=r(11335);let b=["theme"];function L(e){let{theme:t}=e,r=(0,s.Z)(e,b),i=t[E.Z];return(0,n.jsx)(w,(0,a.Z)({},r,{themeId:i?E.Z:void 0,theme:i||t}))}let j=(0,o.Z)({palette:{primary:{main:"#1976d2",light:"#42a5f5",dark:"#1565c0"},secondary:{main:"#9c27b0",light:"#ba68c8",dark:"#7b1fa2"},error:{main:"#d32f2f",light:"#ef5350",dark:"#c62828"},background:{default:"#f5f5f5",paper:"#ffffff"}},typography:{fontFamily:'-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif'},shape:{borderRadius:8},components:{MuiButton:{styleOverrides:{root:{textTransform:"none",fontWeight:600}}},MuiPaper:{styleOverrides:{root:{backgroundImage:"none"}}}}});function S(e){let{children:t}=e;return(0,n.jsx)(L,{theme:j,children:t})}let x=(0,l.createContext)(null);function P(e){let{children:t}=e,r=function(){let{url:e="ws://localhost:3000/ws",onMessage:t,onError:r,onClose:n,onOpen:i,reconnectAttempts:o=5,reconnectInterval:a=3e3}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[s,u]=(0,l.useState)(!1),[c,d]=(0,l.useState)(null),[f,h]=(0,l.useState)([]),g=(0,l.useRef)(null),p=(0,l.useRef)(0);return(0,l.useEffect)(()=>{let s=()=>{try{let l=new WebSocket(e);l.onopen=e=>{u(!0),d(null),p.current=0,null==i||i(e)},l.onmessage=e=>{h(t=>[...t,e.data]);try{let r=JSON.parse(e.data);null==t||t(r)}catch(r){null==t||t({type:"raw",data:e.data})}},l.onerror=e=>{d(e),null==r||r(e)},l.onclose=e=>{u(!1),null==n||n(e),p.current<o&&setTimeout(()=>{p.current+=1,s()},a)},g.current=l}catch(e){d(e),null==r||r(e)}};return s(),()=>{g.current&&g.current.close()}},[e,t,r,n,i,o,a]),{isConnected:s,error:c,send:e=>{g.current&&s&&g.current.send("string"==typeof e?e:JSON.stringify(e))},messages:f}}();return(0,n.jsx)(x.Provider,{value:r,children:t})}function _(e){let{children:t}=e;return(0,n.jsx)(S,{children:(0,n.jsx)(i.H,{children:(0,n.jsx)(P,{children:t})})})}},93346:function(e,t,r){"use strict";r.d(t,{V:function(){return u}});var n=r(14749),i=r(70444),o=r(64090),a=r(3827);let s=["value"],l=o.createContext(),u=()=>{let e=o.useContext(l);return null!=e&&e};t.Z=function(e){let{value:t}=e,r=(0,i.Z)(e,s);return(0,a.jsx)(l.Provider,(0,n.Z)({value:null==t||t},r))}},61733:function(e,t,r){"use strict";var n=r(64090),i=r(66216);t.Z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=n.useContext(i.T);return t&&0!==Object.keys(t).length?t:e}},47907:function(e,t,r){"use strict";var n=r(15313);r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},52445:function(){},43445:function(e){e.exports={style:{fontFamily:"'__Inter_d65c78', '__Inter_Fallback_d65c78'",fontStyle:"normal"},className:"__className_d65c78"}}},function(e){e.O(0,[463,971,69,744],function(){return e(e.s=12618)}),_N_E=e.O()}]);