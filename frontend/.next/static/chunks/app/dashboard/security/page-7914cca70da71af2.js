(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[133],{33493:function(e,r,t){Promise.resolve().then(t.bind(t,41381))},27990:function(e,r,t){"use strict";t.d(r,{Cd:function(){return o},X:function(){return d},bZ:function(){return l}});var s=t(3827);t(64090);var a=t(49769),i=t(93933);let n=(0,a.j)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-background text-foreground",destructive:"text-destructive-foreground [&>svg]:text-current *:data-[slot=alert-description]:text-destructive-foreground/80"}},defaultVariants:{variant:"default"}});function l(e){let{className:r,variant:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,i.cn)(n({variant:t}),r),...a})}function o(e){let{className:r,...t}=e;return(0,s.jsx)("div",{"data-slot":"alert-title",className:(0,i.cn)("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",r),...t})}function d(e){let{className:r,...t}=e;return(0,s.jsx)("div",{"data-slot":"alert-description",className:(0,i.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",r),...t})}},41381:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return I}});var s=t(3827),a=t(4598),i=t(64090),n=t(93933);let l=i.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})});l.displayName="Card";let o=i.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...a})});o.displayName="CardHeader";let d=i.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("h3",{ref:r,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});d.displayName="CardTitle",i.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("p",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",t),...a})}).displayName="CardDescription";let c=i.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("p-6 pt-0",t),...a})});c.displayName="CardContent",i.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",t),...a})}).displayName="CardFooter";var u=t(71399);let f=u.fC,h=i.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(u.aV,{ref:r,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...a})});h.displayName=u.aV.displayName;let x=i.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(u.xz,{ref:r,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...a})});x.displayName=u.xz.displayName;let m=i.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(u.VY,{ref:r,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...a})});m.displayName=u.VY.displayName;var g=t(50674),j=t(81006),p=t(63280);let v=i.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:r,className:(0,n.cn)("w-full caption-bottom text-sm",t),...a})})});v.displayName="Table";let y=i.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("thead",{ref:r,className:(0,n.cn)("[&_tr]:border-b",t),...a})});y.displayName="TableHeader";let b=i.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("tbody",{ref:r,className:(0,n.cn)("[&_tr:last-child]:border-0",t),...a})});b.displayName="TableBody",i.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("tfoot",{ref:r,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...a})}).displayName="TableFooter";let w=i.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("tr",{ref:r,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...a})});w.displayName="TableRow";let N=i.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("th",{ref:r,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...a})});N.displayName="TableHead";let C=i.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("td",{ref:r,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...a})});function R(e){var r;let{columns:t,data:a}=e,i=(0,j.b7)({data:a,columns:t,getCoreRowModel:(0,p.sC)()});return(0,s.jsx)("div",{className:"rounded-md border",children:(0,s.jsxs)(v,{children:[(0,s.jsx)(y,{children:i.getHeaderGroups().map(e=>(0,s.jsx)(w,{children:e.headers.map(e=>(0,s.jsx)(N,{children:e.isPlaceholder?null:(0,j.ie)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,s.jsx)(b,{children:(null===(r=i.getRowModel().rows)||void 0===r?void 0:r.length)?i.getRowModel().rows.map(e=>(0,s.jsx)(w,{"data-state":e.getIsSelected()&&"selected",children:e.getVisibleCells().map(e=>(0,s.jsx)(C,{children:(0,j.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,s.jsx)(w,{children:(0,s.jsx)(C,{colSpan:t.length,className:"h-24 text-center",children:"No results."})})})]})})}C.displayName="TableCell",i.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("caption",{ref:r,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",t),...a})}).displayName="TableCaption";var L=t(27990),A=t(59143);let E=(0,t(49769).j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function K(e){let{className:r,variant:t,asChild:a=!1,...i}=e,l=a?A.g7:"div";return(0,s.jsx)(l,{className:(0,n.cn)(E({variant:t}),r),...i})}var k=t(57531);let T=i.forwardRef((e,r)=>{let{className:t,children:a,...i}=e;return(0,s.jsxs)(k.fC,{ref:r,className:(0,n.cn)("relative overflow-hidden",t),...i,children:[(0,s.jsx)(k.l_,{className:"h-full w-full rounded-[inherit]",children:a}),(0,s.jsx)(S,{}),(0,s.jsx)(k.Ns,{})]})});T.displayName=k.fC.displayName;let S=i.forwardRef((e,r)=>{let{className:t,orientation:a="vertical",...i}=e;return(0,s.jsx)(k.gb,{ref:r,orientation:a,className:(0,n.cn)("flex touch-none select-none transition-colors","vertical"===a&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===a&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...i,children:(0,s.jsx)(k.q4,{className:"relative flex-1 rounded-full bg-border"})})});S.displayName=k.gb.displayName;var P=t(26587),F=t(66363),O=t(38333),q=t(23356),_=t(22983),z=t(10166),D=t(94866),V=t(98061),Z=t(81433),H=t(78720),M=t(24897),B=t(98308);function J(e){let{data:r,xField:t="name",yField:a="value",width:i=500,height:n=300}=e;return(0,s.jsx)(P.h,{width:"100%",height:n,children:(0,s.jsxs)(F.w,{data:r,children:[(0,s.jsx)(O.q,{strokeDasharray:"3 3"}),(0,s.jsx)(q.K,{dataKey:t}),(0,s.jsx)(_.B,{}),(0,s.jsx)(z.u,{}),(0,s.jsx)(D.D,{}),(0,s.jsx)(V.x,{type:"monotone",dataKey:a,stroke:"#8884d8"})]})})}function X(e){let{data:r,xField:t="name",yField:a="value",width:i=500,height:n=300}=e;return(0,s.jsx)(P.h,{width:"100%",height:n,children:(0,s.jsxs)(Z.v,{data:r,children:[(0,s.jsx)(O.q,{strokeDasharray:"3 3"}),(0,s.jsx)(q.K,{dataKey:t}),(0,s.jsx)(_.B,{}),(0,s.jsx)(z.u,{}),(0,s.jsx)(D.D,{}),(0,s.jsx)(H.$,{dataKey:a,fill:"#8884d8"})]})})}function G(e){let{data:r,width:t=400,height:a=300,angleField:i="value",colorField:n="name"}=e;return(0,s.jsx)(P.h,{width:"100%",height:a,children:(0,s.jsxs)(M.u,{data:r,width:t,height:a,children:[(0,s.jsx)(B.b,{data:r,dataKey:i,nameKey:n,cx:"50%",cy:"50%",outerRadius:80,fill:"#8884d8",label:!0}),(0,s.jsx)(z.u,{}),(0,s.jsx)(D.D,{})]})})}let U={low:"default",medium:"secondary",high:"destructive"};function W(){let e=[{accessorKey:"timestamp",header:"Time"},{accessorKey:"type",header:"Type"},{accessorKey:"severity",header:"Severity",cell:e=>{let{row:r}=e;return(0,s.jsx)(K,{variant:U[r.original.severity],children:r.original.severity})}},{accessorKey:"description",header:"Description"},{accessorKey:"locations",header:"Locations",cell:e=>{let{row:r}=e;return r.original.locations.join(", ")}}],{data:r}=(0,g.a)({queryKey:["security-events"],queryFn:async()=>(await fetch("/api/security/events")).json()}),{data:t}=(0,g.a)({queryKey:["permissions"],queryFn:async()=>(await fetch("/api/security/permissions")).json()}),{data:a}=(0,g.a)({queryKey:["zones"],queryFn:async()=>(await fetch("/api/security/zones")).json()});return(0,s.jsxs)("div",{className:"container mx-auto p-6",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Security Dashboard"}),(0,s.jsxs)(f,{defaultValue:"overview",children:[(0,s.jsxs)(h,{children:[(0,s.jsx)(x,{value:"overview",children:"Overview"}),(0,s.jsx)(x,{value:"events",children:"Events"}),(0,s.jsx)(x,{value:"permissions",children:"Permissions"}),(0,s.jsx)(x,{value:"zones",children:"Zones"}),(0,s.jsx)(x,{value:"alerts",children:"Alerts"})]}),(0,s.jsx)(m,{value:"overview",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,s.jsxs)(l,{children:[(0,s.jsx)(o,{children:(0,s.jsx)(d,{children:"Active Users"})}),(0,s.jsx)(c,{children:(0,s.jsx)(J,{data:[],xField:"time",yField:"count"})})]}),(0,s.jsxs)(l,{children:[(0,s.jsx)(o,{children:(0,s.jsx)(d,{children:"Security Events"})}),(0,s.jsx)(c,{children:(0,s.jsx)(G,{data:[],angleField:"value",colorField:"type"})})]}),(0,s.jsxs)(l,{children:[(0,s.jsx)(o,{children:(0,s.jsx)(d,{children:"Access Attempts"})}),(0,s.jsx)(c,{children:(0,s.jsx)(X,{data:[],xField:"zone",yField:"count"})})]})]})}),(0,s.jsx)(m,{value:"events",children:(0,s.jsxs)(l,{children:[(0,s.jsx)(o,{children:(0,s.jsx)(d,{children:"Security Events"})}),(0,s.jsx)(c,{children:(0,s.jsx)(R,{columns:e,data:r||[]})})]})}),(0,s.jsx)(m,{value:"permissions",children:(0,s.jsxs)(l,{children:[(0,s.jsx)(o,{children:(0,s.jsx)(d,{children:"Access Permissions"})}),(0,s.jsx)(c,{children:(0,s.jsx)(R,{columns:[{accessorKey:"role",header:"Role"},{accessorKey:"resource",header:"Resource"},{accessorKey:"action",header:"Action",cell:e=>{let{row:r}=e;return(0,s.jsx)(K,{children:r.original.action})}},{accessorKey:"location",header:"Location"}],data:t||[]})})]})}),(0,s.jsx)(m,{value:"zones",children:(0,s.jsxs)(l,{children:[(0,s.jsx)(o,{children:(0,s.jsx)(d,{children:"Security Zones"})}),(0,s.jsx)(c,{children:(0,s.jsx)(R,{columns:[{accessorKey:"name",header:"Zone Name"},{accessorKey:"level",header:"Security Level"},{accessorKey:"requiredAccess",header:"Required Access",cell:e=>{let{row:r}=e;return(0,s.jsx)("div",{className:"flex gap-1",children:r.original.requiredAccess.map(e=>(0,s.jsx)(K,{variant:"outline",children:e},e))})}},{accessorKey:"locations",header:"Locations",cell:e=>{let{row:r}=e;return(0,s.jsx)("div",{className:"flex gap-1",children:r.original.locations.map(e=>(0,s.jsx)(K,{variant:"outline",children:e},e))})}}],data:a||[]})})]})}),(0,s.jsx)(m,{value:"alerts",children:(0,s.jsxs)(l,{children:[(0,s.jsx)(o,{children:(0,s.jsx)(d,{children:"Active Alerts"})}),(0,s.jsx)(c,{children:(0,s.jsxs)(T,{className:"h-[500px]",children:[(0,s.jsxs)(L.bZ,{className:"mb-4",children:[(0,s.jsx)(L.Cd,{children:"Unauthorized Access Attempt"}),(0,s.jsx)(L.X,{children:"Multiple failed access attempts at Main Entrance"})]}),(0,s.jsxs)(L.bZ,{className:"mb-4",children:[(0,s.jsx)(L.Cd,{children:"Camera Offline"}),(0,s.jsx)(L.X,{children:"Security camera in Zone B is offline"})]})]})})]})})]})]})}var Y=t(2888);function I(){let{user:e}=(0,Y.aC)();return e?(0,s.jsx)(a.Z,{maxWidth:"lg",children:(0,s.jsx)(W,{})}):null}},2888:function(e,r,t){"use strict";t.d(r,{aC:function(){return i}});var s=t(64090),a=t(84586);function i(){let e=(0,s.useContext)(a.V);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}t(47907)},93933:function(e,r,t){"use strict";t.d(r,{cn:function(){return i}});var s=t(75504),a=t(51367);function i(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.m6)((0,s.W)(r))}t(49079)},84586:function(e,r,t){"use strict";t.d(r,{H:function(){return l},V:function(){return n}});var s=t(3827),a=t(64090),i=t(47907);let n=(0,a.createContext)(null);function l(e){let{children:r}=e,t=(0,i.useRouter)(),[l,o]=(0,a.useState)({user:null,isAuthenticated:!1,isLoading:!0,error:null}),d=e=>{o(r=>({...r,error:e}))},c=async e=>{try{d(null),o(e=>({...e,isLoading:!0})),o(r=>({...r,user:e,isAuthenticated:!0,isLoading:!1})),t.push("/dashboard")}catch(e){throw o(r=>({...r,isLoading:!1,error:e instanceof Error?e.message:"Login failed"})),e}},u=async e=>{try{var r;d(null),o(e=>({...e,isLoading:!0}));let s=await fetch("/api/auth/login/face",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({faceData:e})});if(!s.ok)throw Error("Face recognition login failed");let a=await s.json();if(!a.success||!(null===(r=a.data)||void 0===r?void 0:r.user))throw Error(a.error||"Face recognition login failed");o(e=>({...e,user:a.data.user,isAuthenticated:!0,isLoading:!1})),t.push("/dashboard")}catch(e){throw o(r=>({...r,isLoading:!1,error:e instanceof Error?e.message:"Face recognition login failed"})),e}},f=async e=>{try{var r;d(null),o(e=>({...e,isLoading:!0}));let s=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!s.ok)throw Error("Registration failed");let a=await s.json();if(!a.success||!(null===(r=a.data)||void 0===r?void 0:r.user))throw Error(a.error||"Registration failed");o(e=>({...e,user:a.data.user,isAuthenticated:!0,isLoading:!1})),t.push("/dashboard")}catch(e){throw o(r=>({...r,isLoading:!1,error:e instanceof Error?e.message:"Registration failed"})),e}},h=async()=>{try{d(null),o(e=>({...e,isLoading:!0})),await fetch("/api/auth/logout",{method:"POST",credentials:"include"}),o({user:null,isAuthenticated:!1,isLoading:!1,error:null}),t.push("/login")}catch(e){o(r=>({...r,isLoading:!1,error:e instanceof Error?e.message:"Logout failed"}))}},x=async e=>{try{d(null),o(e=>({...e,isLoading:!0}));let r=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:e})});if(!r.ok)throw Error("Password reset failed");let t=await r.json();if(!t.success)throw Error(t.error||"Password reset failed");o(e=>({...e,isLoading:!1}))}catch(e){throw o(r=>({...r,isLoading:!1,error:e instanceof Error?e.message:"Password reset failed"})),e}},m=async(e,r,s)=>{try{d(null),o(e=>({...e,isLoading:!0}));let a=await fetch("/api/auth/update-password",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({token:e,password:r,confirmPassword:s})});if(!a.ok)throw Error("Password update failed");let i=await a.json();if(!i.success)throw Error(i.error||"Password update failed");o(e=>({...e,isLoading:!1})),t.push("/login")}catch(e){throw o(r=>({...r,isLoading:!1,error:e instanceof Error?e.message:"Password update failed"})),e}};(0,a.useEffect)(()=>{!async function(){try{var e;let r=await fetch("/api/auth/me",{method:"GET",credentials:"include"});if(!r.ok)throw Error("Authentication check failed");let t=await r.json();t.success&&(null===(e=t.data)||void 0===e?void 0:e.user)?o({user:t.data.user,isAuthenticated:!0,isLoading:!1,error:null}):o({user:null,isAuthenticated:!1,isLoading:!1,error:null})}catch(e){o({user:null,isAuthenticated:!1,isLoading:!1,error:e instanceof Error?e.message:"Authentication check failed"})}}()},[]);let g={...l,login:c,loginWithFace:u,register:f,logout:h,resetPassword:x,updatePassword:m};return(0,s.jsx)(n.Provider,{value:g,children:r})}}},function(e){e.O(0,[180,463,26,437,358,971,69,744],function(){return e(e.s=33493)}),_N_E=e.O()}]);